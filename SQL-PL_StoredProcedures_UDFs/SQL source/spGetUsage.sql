drop procedure VGCUSTOM/spGetUsage;--@#create procedure VGCUSTOM/spGetUsage(	in inAcctNo char(7),	in inYear char(4),	in inTranType char(3))result sets 1language sqlbegin	declare c1 cursor with return for		SELECT  	act.UMACT,				act.UMNAM,				act.UMPRM,				prm.UPSAD,				bl.BHVMTR,				bl.BHVCRD,				bl.BHVBLD,                bl.BHVRYM as BILL_PERIOD,				bl.BHVUOM,				case					when BHVUOR = 'R' then 'Actual'					when BHVUOR = 'U' then 'Estimated'				end as BHVUOR,				BHVCUR,				case					when BHVUOR = 'R' then BHVMUS					when BHVUOR = 'U' then BHVESU				end as Usage					FROM 		UBLHRPRM as bl	left join 	UPRM as prm on bl.bhvprm = prm.UPPRM 	left join 	UACT as act on bl.BHVPRM = act.umact	WHERE 	(bhvACT  = inAcctNo)	and 	substring(char(BHVBLD),1,4)= inYear	and (	( inTranType = 'ACT' and BHVUOR = 'R' )		 or ( inTranType = 'EST' and BHVUOR = 'U' )		 or ( inTranType = 'ALL' and BHVUOR in ('R', 'U') )	)	ORDER BY BHVBLD desc;	open c1;end